<div class="container mt-4">
  <h3>Contacts</h3>

  <div class="row mb-3">
    <div class="col-md-4">
      <input
        class="form-control"
        placeholder="Search contacts..."
        [(ngModel)]="searchText"
        (keyup.enter)="onSearchOrClear()"
      />
    </div>

    <div class="col-md-2">
      <button
        class="btn w-100"
        [ngClass]="{
          'btn-primary': !isSearchActive,
          'btn-danger': isSearchActive,
        }"
        (click)="onSearchOrClear()"
      >
        {{ isSearchActive ? 'Clear' : 'Search' }}
      </button>
    </div>
  </div>

  <!-- SKELETON TABLE -->
<div *ngIf="loading" class="table-responsive">
  <table class="table table-bordered">
    <tbody>
      <tr class="skeleton-row" *ngFor="let _ of [1,2,3]">
        <td><div class="skeleton skeleton-sm"></div></td>
        <td><div class="skeleton skeleton-md"></div></td>
        <td><div class="skeleton skeleton-lg"></div></td>
        <td><div class="skeleton skeleton-sm"></div></td>
      </tr>
    </tbody>
  </table>
</div>


  <!-- TABLE -->
  <div class="table-responsive" *ngIf="!loading">
    <table class="table table-bordered table-hover">
      <thead class="table-dark">
        <tr>
          <th (click)="toggleSort()" style="cursor: pointer">
            First Name
            <span *ngIf="sortOrder === 'asc'">⬆</span>
            <span *ngIf="sortOrder === 'desc'">⬇</span>
          </th>
          <th>Last Name</th>
          <th>Mobile</th>
          <th>City</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let c of contacts">
          <td>{{ c.firstName }}</td>
          <td>{{ c.lastName }}</td>
          <td>{{ c.mobile1 }}</td>
          <td>{{ c.address?.city }}</td>
        </tr>

        <tr *ngIf="contacts.length === 0">
          <td colspan="4" class="text-center text-muted">No contacts found</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- PAGINATION + PAGE SIZE -->
  <div class="d-flex justify-content-between align-items-center mt-3">
    <!-- PAGE SIZE -->
    <div class="d-flex align-items-center gap-2">
      <span>Rows:</span>
      <select
        class="form-select form-select-sm"
        style="width: 90px"
        [(ngModel)]="limit"
        (change)="onPageSizeChange()"
      >
        <option *ngFor="let size of pageSizeOptions" [ngValue]="size">
          {{ size }}
        </option>
      </select>
    </div>

    <!-- PAGINATION -->
    <ul class="pagination mb-0">
      <li class="page-item" [class.disabled]="page === 1">
        <button class="page-link" (click)="prevPage()">Previous</button>
      </li>

      <li class="page-item" *ngFor="let p of getPageNumbers()" [class.active]="p === page">
        <button class="page-link" (click)="goToPage(p)">
          {{ p }}
        </button>
      </li>

      <li class="page-item" [class.disabled]="page === totalPages">
        <button class="page-link" (click)="nextPage()">Next</button>
      </li>
    </ul>
  </div>
</div>
